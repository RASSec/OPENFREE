def check(ip):
    print("Trying:" + ip + ' ' + '[' + str(left) + '/' + str(countLines) + ']')
    sock = socket.socket(socket.AF_INET)
    sock.settimeout(3)
    try:
        sock.connect(( str(ip),  445 ))
    except Exception as err:
        sock.close()
        print(err)
        return
    sock.send(pkt)
    nb, = struct.unpack(">I", sock.recv(4))
    res = sock.recv(nb)
    if res[68:70] != b"\x11\x03" or res[70:72] != b"\x02\x00":
        print(ip + " " + "Not vulnerable")
    else:
        print(ip + " " + "vulnerable")
        with open(path_out,'a') as f:
            f.write(ip + '\n')
